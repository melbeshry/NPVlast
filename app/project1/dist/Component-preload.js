//@ui5-bundle project1/Component-preload.js
sap.ui.require.preload({
	"project1/Component.js":function(){
sap.ui.define(["sap/ui/core/UIComponent","project1/model/models"],(e,t)=>{"use strict";return e.extend("project1.Component",{metadata:{manifest:"json",interfaces:["sap.ui.core.IAsyncContentCreation"]},init(){e.prototype.init.apply(this,arguments);this.setModel(t.createDeviceModel(),"device");this.getRouter().initialize()}})});
},
	"project1/controller/App.controller.js":function(){
sap.ui.define(["sap/ui/core/mvc/Controller"],e=>{"use strict";return e.extend("project1.controller.App",{onInit(){}})});
},
	"project1/controller/Configuration.controller.js":function(){
sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/Column","sap/m/Text","sap/m/Input","sap/m/MessageToast"],function(e,t,a,o,n,r){"use strict";return e.extend("project1.controller.Configuration",{onInit:function(){var e=new t({frequency:"Annual"});this.getView().setModel(e,"config");var a={};a["First 4 Months"]=Array(20).fill().map(()=>({value:""}));for(var o=1;o<=20;o++){var n=o+"YP";a[n]=Array(20).fill().map(()=>({value:""}))}var r=new t(a);console.log("Initial Periods Model:",JSON.stringify(r.getData(),null,2));r.setDefaultBindingMode(sap.ui.model.BindingMode.TwoWay);this.getView().setModel(r,"periods");var s=this.getOwnerComponent().getModel("npvModel");this._loadDataFromOData(s,e,r).then(()=>{this._createPeriodTable()}).catch(e=>{console.error("Failed to load data:",e)})},_createPeriodTable:function(){var e=this.byId("periodsTable");var t=this.getView().getModel("periods");var r=t.getData();e.removeAllColumns();e.unbindItems();var s=20;e.addColumn(new a({header:new o({text:"Period Name"})}));for(var i=1;i<=s;i++){e.addColumn(new a({header:new o({text:i+"YP"})}))}e.bindItems({path:"periods>/",factory:function(e,t){var a=t.getPath().split("/").pop();var r=[];r.push(new o({text:a}));for(var i=1;i<=s;i++){if(a==="First 4 Months"){var l=i-1;r.push(new n({value:"{periods>/"+a+"/"+l+"/value}",type:"Number",change:this._onInputChange.bind(this)}))}else{var u=parseInt(a.replace("YP",""),10);if(!isNaN(u)&&i>=u){var d=i-u;r.push(new n({value:"{periods>/"+a+"/"+d+"/value}",type:"Number",change:this._onInputChange.bind(this)}))}else{r.push(new o({text:""}))}}}return new sap.m.ColumnListItem({cells:r})}.bind(this)})},_onInputChange:function(e){var t=e.getSource();var a=t.getValue().trim();var o=t.getBinding("value").getPath();var n="/periods"+o;var s=this.getView().getModel("periods");console.log("Full Path:",n,"New Value:",a,"Current Model Value:",s.getProperty(n));if(a===""){return}var i=parseFloat(a);if(isNaN(i)||i<0||i>100){t.setValueState("Error");t.setValueStateText("Please enter a valid number between 0 and 100.");r.show("Please enter a valid number between 0 and 100.")}else{t.setValueState("None")}},_loadDataFromOData:function(e,t,a){if(!e){console.warn("OData model not found; skipping load");return Promise.resolve()}return e.bindList("/Configurations",undefined,undefined,undefined,{$expand:"periods($expand=percentages)"}).requestContexts().then(function(e){if(e.length>0){var o=e[0].getObject();t.setData({frequency:o.frequency,lastUpdatedBy:o.lastUpdatedBy||"Unknown"});var n=a.getData();var r={...n};if(o.periods){var s=o.periods.results||o.periods;s.forEach(function(e){var t=e.periodName;var a=e.percentages.results||e.percentages;r[t]=Array(20).fill().map((e,t)=>({value:a[t]&&a[t].value!=null?a[t].value.toString():""}))})}a.setData(r);console.log("Merged Periods Model:",JSON.stringify(r,null,2))}else{console.log("No Configurations found; using defaults.")}})},onSave:function(){var e=this.getView().getModel("periods");var t=this.getView().getModel("config");if(!e||!t){console.error("Required models not found.");return}var a=e.getData();for(var o in a){var n=0;a[o].forEach(function(e){var t=parseFloat(e.value)||0;n+=t});if(n>100){r.show(`Total for ${o} exceeds 100% (${n.toFixed(2)}%). Please correct.`);return}}var s=t.getData();var i=Object.keys(a).map(function(e){return{periodName:e,percentages:a[e].map(function(e,t){return{index:t,value:parseFloat(e.value)||0}})}});var l={frequency:s.frequency,periods:i};console.log("Payload:",JSON.stringify(l,null,2));var u=this.getOwnerComponent().getModel("npvModel");if(!u){console.error("OData model not found.");r.show("Error: OData model not available");return}u.bindList("/Configurations").requestContexts().then(function(e){if(e.length>0){var t=e[0];var a=t.getObject().ID;var o=u.bindContext(`/Configurations(${a})`);o.requestObject().then(function(e){o.getBoundContext().setProperty("frequency",l.frequency);var t=u.bindList(`/Configurations(${a})/periods`);t.requestContexts().then(function(e){e.forEach(function(e){e.delete()});l.periods.forEach(function(e){t.create({periodName:e.periodName,percentages:e.percentages})});u.submitBatch("updateGroup").then(function(){r.show("Data updated successfully!");console.log("Update successful")}).catch(function(e){console.error("Error updating data:",e);r.show("Failed to update data: "+e.message)})}).catch(function(e){console.error("Error managing periods:",e);r.show("Failed to manage periods: "+e.message)})}).catch(function(e){console.error("Error fetching entity data:",e);r.show("Failed to fetch entity data: "+e.message)})}else{u.bindList("/Configurations").create(l,{success:function(){r.show("Data saved successfully!");console.log("Create successful")},error:function(e){console.error("Error saving data:",e);r.show("Failed to save data: "+e.message)}});u.submitBatch("updateGroup").then(function(){console.log("Batch submitted for creation")}).catch(function(e){console.error("Batch submission failed:",e);r.show("Failed to submit batch: "+e.message)})}}).catch(function(e){console.error("Error checking existing configurations:",e);r.show("Error accessing service: "+e.message)})}})});
},
	"project1/controller/Homepage.controller.js":function(){
sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel"],function(e,t){"use strict";return e.extend("project1.controller.Homepage",{onInit:function(){var e=new t({selectedKey:"sales"});this.getView().setModel(e,"tabBar")},onTabSelect:function(e){var t=e.getParameter("key");this.getView().getModel("tabBar").setProperty("/selectedKey",t)}})});
},
	"project1/controller/Sales.controller.js":function(){
sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/Column","sap/m/Text","sap/m/Input","sap/m/MessageToast"],function(e,a,t,n,r,o){"use strict";return e.extend("project1.controller.Sales",{onInit:function(){const e=new URLSearchParams(window.location.search);const t=e.get("discountRate")||"";const n=e.get("unitNpv")||"";const r=e.get("pricePlan")||"";const l=e.get("leadId")||"";const i=new a({unitNpv:n,discountRate:t,leadId:l,pricePlan:r,tableData:[],futureValue:"",npv:""});this.getView().setModel(i,"sales");var s=this.getOwnerComponent().getModel("npvModel");if(!s){console.error("OData model not found.");o.show("Error: OData model not available");return}var u=this;this._loadDataFromOData(s).then(function(e){console.log("Loaded config data:",e);o.show("Frequency: "+e.frequency);var a=u._getRowCount(e.frequency);var t=a+2;console.log("Row count (including Downpayment and Contract Payment):",t);var n=u._initializeTableData(t,parseInt(i.getProperty("/pricePlan").replace("YP",""))||1,e.frequency);i.setProperty("/tableData",n);u._oConfigData=e;u._generateTable()}).catch(function(e){console.error("Error loading frequency:",e);o.show("Error loading frequency, defaulting to Annual");u._buildTableWithDefault(u.byId("salesTable"),parseInt(i.getProperty("/pricePlan").replace("YP",""))||1,i)})},onPricePlanChange:function(e){var a=e.getParameter("selectedItem").getKey();var t=this.getView().getModel("sales");t.setProperty("/pricePlan",a);this._generateTable()},_generateTable:function(){var e=this.getView();var a=e.getModel("sales");var r=a.getProperty("/pricePlan");var l=this.byId("salesTable");l.removeAllColumns();a.setProperty("/tableData",[]);a.setProperty("/futureValue","");a.setProperty("/npv","");if(!r||r===""){return}var i=parseInt(r.replace("YP",""))||1;var s=this.getOwnerComponent().getModel("npvModel");if(!s){console.error("OData model not found.");o.show("Error: OData model not available");return}var u=this;this._loadDataFromOData(s).then(function(e){console.log("Loaded config data:",e);o.show("Frequency: "+e.frequency);var r=u._getRowCount(e.frequency);var s=r+2;console.log("Row count (including Downpayment and Contract Payment):",s);var c=u._initializeTableData(s,i,e.frequency);l.addColumn(new t({header:new n({text:"Period"})}));for(var d=1;d<=i;d++){l.addColumn(new t({header:new n({text:`Year ${d}`})}))}l.bindItems({path:"sales>/tableData",factory:function(a,t){return new sap.m.ColumnListItem({cells:u._createCells(i,e.frequency,t)})}});a.setProperty("/tableData",c);u._oConfigData=e}).catch(function(e){console.error("Error loading frequency:",e);o.show("Error loading frequency, defaulting to Annual");u._buildTableWithDefault(l,i,a)})},_loadDataFromOData:function(e){return new Promise(function(a,t){if(!e){t("OData model not found");return}e.bindList("/Configurations",undefined,undefined,undefined,{$expand:"periods($expand=percentages)"}).requestContexts().then(function(e){console.log("OData Contexts Retrieved:",e);if(e.length>0){var t=e[0].getObject();console.log("Raw OData Response:",JSON.stringify(t,null,2));a({frequency:t.frequency,periods:t.periods.results||t.periods})}else{console.log("No Configurations found, defaulting to Annual");a({frequency:"Annual",periods:[]})}}).catch(function(e){console.error("Error loading Configurations:",e);t(e)})})},_buildTableWithDefault:function(e,a,r){var o=this._getRowCount("Annual")+2;var l=this._initializeTableData(o,a,"Annual");e.addColumn(new t({header:new n({text:"Period"})}));for(var i=1;i<=a;i++){e.addColumn(new t({header:new n({text:`Year ${i}`})}))}e.bindItems({path:"sales>/tableData",factory:function(e,t){return new sap.m.ColumnListItem({cells:this._createCells(a,"Annual",t)})}.bind(this)});r.setProperty("/tableData",l);this._oConfigData={frequency:"Annual",periods:[]}},_getRowCount:function(e){console.log("Evaluating frequency:",e);switch(e){case"Annual":return 1;case"Semi":return 2;case"Quarter":return 4;case"Monthly":return 12;case"Daily":return 365;default:console.warn("Unknown frequency, defaulting to 1:",e);return 1}},_initializeTableData:function(e,a,t){var n=[];var r=this._getPeriodLabels(t,e);for(var o=0;o<e;o++){var l={period:r[o]};for(var i=0;i<a;i++){l[`col${i}`]=""}n.push(l)}console.log("Table data:",JSON.stringify(n,null,2));return n},_getPeriodLabels:function(e,a){var t;switch(e){case"Annual":t=["Year"];break;case"Semi":t=["H1","H2"];break;case"Quarter":t=["Q1","Q2","Q3","Q4"];break;case"Monthly":t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];break;case"Daily":t=Array.from({length:365},(e,a)=>`Day ${a+1}`);break;default:t=Array.from({length:this._getRowCount(e)},(e,a)=>`Period ${a+1}`)}return["Downpayment","Contract Payment"].concat(t.slice(0,a-2))},_createCells:function(e,a,t){var o=[new n({text:"{sales>period}"})];var l=t.getProperty("period");for(let a=0;a<e;a++){var i=l!=="Downpayment"&&l!=="Contract Payment"||a===0;o.push(new r({value:`{sales>col${a}}`,type:"Number",placeholder:"Enter value",visible:i}))}return o},onSimulate:function(){var e=this.getView().getModel("sales");var a=e.getData();var t=this._oConfigData||{frequency:"Annual",periods:[]};var n=a.pricePlan;var r=parseFloat(a.discountRate)/100||0;var l=a.tableData;console.log("Sales Model Data:",a);console.log("Config Data:",t);if(!n||!a.unitNpv||!a.discountRate||l.length===0){o.show("Please fill in Unit NPV, Discount Rate, Price Plan, and table data before simulating.");return}var i=parseFloat(a.unitNpv)||0;var s=parseInt(n.replace("YP",""))||1;var u=this._getRowCount(t.frequency);var c=0,d=0;l.forEach(function(e){console.log("Row Data:",e);if(e.period==="Downpayment"){c=(parseFloat(e.col0)||0)/100;console.log("Downpayment Percentage:",c)}else if(e.period==="Contract Payment"){d=(parseFloat(e.col0)||0)/100;console.log("Contract Payment Percentage:",d)}});var f=s*u;var p=[];for(var g=1;g<=s;g++){l.forEach(function(e,a){if(e.period!=="Downpayment"&&e.period!=="Contract Payment"){var t=(parseFloat(e[`col${g-1}`])||0)/100;var n=a-2;if(n>=0&&n<u){p.push(t);console.log(`E Calc Year ${g}, Period ${e.period}:`,{basePercentage:t})}}});while(p.length<g*u){p.push(0)}}const y=(1+r)**(1/u)-1;let v=0;for(let e=0;e<p.length;e++){v+=p[e]/(1+y)**(e+1)}v+=c+d;var h=i*(1/v);var m=v.toFixed(6);var w=h.toFixed(2);e.setProperty("/futureValue",w);e.setProperty("/npv",m);o.show(`Simulation completed: Future Value = ${w}, NPV = ${m}`);console.log("Frequency:",t.frequency,"Periods per Year:",u,"E Array:",p,"Downpayment:",c,"Contract Payment:",d,"NPV (full precision):",v,"NPV (display):",m,"Future Value (full precision):",h,"Future Value (display):",w)}})});
},
	"project1/i18n/i18n.properties":'# This is the resource bundle for project1\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=App Title\n\n#YDES: Application description\nappDescription=An SAP Fiori application.\n#XTIT: Main view title\ntitle=App Title',
	"project1/manifest.json":'{"_version":"1.65.0","sap.app":{"id":"project1","type":"application","i18n":"i18n/i18n.properties","applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.16.5","toolsId":"84dd506c-d3cb-4732-8443-478f585571c2"},"dataSources":{"mainService":{"uri":"odata/v4/npv/","type":"OData","settings":{"annotations":[],"odataVersion":"4.0"}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":true,"dependencies":{"minUI5Version":"1.133.0","libs":{"sap.m":{},"sap.ui.core":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"project1.i18n.i18n"}},"npvModel":{"dataSource":"mainService","preload":true,"settings":{"operationMode":"Server","autoExpandSelect":true,"earlyRequests":true}}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","controlAggregation":"pages","controlId":"app","transition":"slide","type":"View","viewType":"XML","path":"project1.view"},"routes":[{"name":"RouteHomepage","pattern":":?query:","target":["TargetHomepage"]}],"targets":{"TargetHomepage":{"id":"Homepage","name":"Homepage"}}},"rootView":{"viewName":"project1.view.App","type":"XML","id":"App"}},"sap.cloud":{"public":true,"service":"NPV-approuter"}}',
	"project1/model/models.js":function(){
sap.ui.define(["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
},
	"project1/view/App.view.xml":'<mvc:View controllerName="project1.controller.App"\n    displayBlock="true"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"><App id="app"></App></mvc:View>',
	"project1/view/Configuration.view.xml":'<mvc:View \n    controllerName="project1.controller.Configuration"\n    xmlns:mvc="sap.ui.core.mvc" \n    xmlns="sap.m" \n    xmlns:core="sap.ui.core"><VBox id="_IDGenVBox2" class="sapUiSmallMargin"><Button id="saveButton" text="Save" press=".onSave" class="sapUiTinyMarginTop"/><Label id="_IDGenLabel" text="Frequency" /><Select id="frequencySelect" selectedKey="{config>/frequency}" change=".onFrequencyChange"><items><core:Item id="_IDGenItem" key="Annual" text="Annual"/><core:Item id="_IDGenItem1" key="Semi" text="Semi-Annual"/><core:Item id="_IDGenItem2" key="Quarter" text="Quarterly"/><core:Item id="_IDGenItem3" key="Monthly" text="Monthly"/><core:Item id="_IDGenItem4" key="Daily" text="Daily"/></items></Select><ScrollContainer id="_IDGenScrollContainer" horizontal="true" vertical="true" height="700px"><Table id="periodsTable" items="{periods>/}"><columns><Column id="_IDGenColumn"><Text id="_IDGenText2" text="Period" /></Column></columns><items><ColumnListItem id="_IDGenColumnListItem1"><cells><Text id="_IDGenText3" text="{periods>periodName}" /></cells></ColumnListItem></items></Table></ScrollContainer></VBox></mvc:View>',
	"project1/view/Homepage.view.xml":'<mvc:View controllerName="project1.controller.Homepage"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"><Page id="_IDGenPage1" title="Real Estate NPV Calculator"><content><IconTabBar id="tabBar" select=".onTabSelect" selectedKey="{tabBar>/selectedKey}"><items><IconTabFilter id="_IDGenIconTabFilter" text="Configuration" key="config" icon="sap-icon://settings"/><IconTabFilter id="_IDGenIconTabFilter1" text="Sales" key="sales" icon="sap-icon://sales-order"/></items></IconTabBar><mvc:XMLView id="configView" viewName="project1.view.Configuration" visible="{= ${tabBar>/selectedKey} === \'config\'}"/><mvc:XMLView id="salesView" viewName="project1.view.Sales" visible="{= ${tabBar>/selectedKey} === \'sales\'}"/></content></Page></mvc:View>',
	"project1/view/Sales.view.xml":'<mvc:View \n    controllerName="project1.controller.Sales"\n    xmlns:mvc="sap.ui.core.mvc" \n    xmlns="sap.m" \n    xmlns:form="sap.ui.layout.form" \n    xmlns:core="sap.ui.core"><VBox id="salesVBox"><Title id="salesTitle" text="Sales Input" class="sapUiSmallMarginBottom"/><form:SimpleForm id="salesForm" editable="true" layout="ResponsiveGridLayout"><form:content><Label id="unitNpvLabel" text="Unit NPV"/><Input id="unitNpvInput" type="Number" value="{sales>/unitNpv}"/><Label id="discountRateLabel" text="Discount Rate (%)"/><Input id="discountRateInput" type="Number" value="{sales>/discountRate}"/><Label id="leadIdLabel" text="Lead ID"/><Input id="leadIdInput" type="Number" value="{sales>/leadId}"/><Label id="pricePlanLabel" text="Price Plan"/><Select id="pricePlanSelect" selectedKey="{sales>/pricePlan}" change=".onPricePlanChange"><items><core:Item id="_IDGenItem6" key="" text="Select a plan"/><core:Item id="_IDGenItem7" key="1YP" text="1YP"/><core:Item id="_IDGenItem8" key="2YP" text="2YP"/><core:Item id="_IDGenItem9" key="3YP" text="3YP"/><core:Item id="_IDGenItem10" key="4YP" text="4YP"/><core:Item id="_IDGenItem11" key="5YP" text="5YP"/><core:Item id="_IDGenItem12" key="6YP" text="6YP"/><core:Item id="_IDGenItem13" key="7YP" text="7YP"/><core:Item id="_IDGenItem14" key="8YP" text="8YP"/><core:Item id="_IDGenItem15" key="9YP" text="9YP"/><core:Item id="_IDGenItem16" key="10YP" text="10YP"/><core:Item id="_IDGenItem17" key="11YP" text="11YP"/><core:Item id="_IDGenItem18" key="12YP" text="12YP"/><core:Item id="_IDGenItem19" key="13YP" text="13YP"/><core:Item id="_IDGenItem20" key="14YP" text="14YP"/><core:Item id="_IDGenItem21" key="15YP" text="15YP"/><core:Item id="_IDGenItem22" key="16YP" text="16YP"/><core:Item id="_IDGenItem23" key="17YP" text="17YP"/><core:Item id="_IDGenItem24" key="18YP" text="18YP"/><core:Item id="_IDGenItem25" key="19YP" text="19YP"/><core:Item id="_IDGenItem26" key="20YP" text="20YP"/></items></Select><Label id="futureValueLabel" text="Future Value"/><Input id="futureValueInput" value="{sales>/futureValue}" enabled="false"/><Label id="npvLabel" text="NPV"/><Input id="npvInput" value="{sales>/npv}" enabled="false"/></form:content></form:SimpleForm><Table id="salesTable" items="{sales>/tableData}"><columns><Column id="periodColumn"><Text id="_IDGenText" text="Period"/></Column></columns><items><ColumnListItem id="salesRow"><cells><Text id="_IDGenText1" text="{sales>period}"/></cells></ColumnListItem></items></Table><Button id="simulateButton" text="Simulate" press=".onSimulate" class="sapUiSmallMarginTop"/></VBox></mvc:View>'
});
//# sourceMappingURL=Component-preload.js.map
